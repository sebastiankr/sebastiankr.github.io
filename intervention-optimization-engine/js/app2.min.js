function knapsack(items,capacity){var idxItem=0,idxWeight=0,oldMax=0,newMax=0,numItems=items.length,weightMatrix=new Array(numItems+1),keepMatrix=new Array(numItems+1),solutionSet=[];for(idxItem=0;numItems+1>idxItem;idxItem++)weightMatrix[idxItem]=new Array(capacity+1),keepMatrix[idxItem]=new Array(capacity+1);for(idxItem=0;numItems>=idxItem;idxItem++)for(idxWeight=0;capacity>=idxWeight;idxWeight++)0===idxItem||0===idxWeight?weightMatrix[idxItem][idxWeight]=0:items[idxItem-1].w<=idxWeight?(newMax=items[idxItem-1].b+weightMatrix[idxItem-1][idxWeight-items[idxItem-1].w],oldMax=weightMatrix[idxItem-1][idxWeight],newMax>oldMax?(weightMatrix[idxItem][idxWeight]=newMax,keepMatrix[idxItem][idxWeight]=1):(weightMatrix[idxItem][idxWeight]=oldMax,keepMatrix[idxItem][idxWeight]=0)):weightMatrix[idxItem][idxWeight]=weightMatrix[idxItem-1][idxWeight];for(idxWeight=capacity,idxItem=numItems;idxItem>0;idxItem--)1===keepMatrix[idxItem][idxWeight]&&(solutionSet.push(items[idxItem-1]),idxWeight-=items[idxItem-1].w);return{maxValue:weightMatrix[numItems][capacity],set:solutionSet}}function stackedBarChart(selector,data,yAxis){d3.select(selector).select("svg").remove();var margin={top:20,right:20,bottom:30,left:24},width=340-margin.left-margin.right,height=250-margin.top-margin.bottom,yAxisCount=yAxis,x=d3.scale.ordinal().rangeRoundBands([0,width],.1),y=d3.scale.linear().rangeRound([height,0]),color=d3.scale.ordinal().range(["#98abc5","#8a89a6","#7b6888","#6b486b","#a05d56","#d0743c","#ff8c00"]),xAxis=d3.svg.axis().scale(x).orient("bottom"),yAxis=d3.svg.axis().scale(y).orient("left").tickFormat(d3.format(".2s")),svg=d3.select(selector).append("svg").attr("width",width+margin.left+margin.right).attr("height",height+margin.top+margin.bottom).append("g").attr("transform","translate("+margin.left+","+margin.top+")");color.domain(d3.keys(data[0]).filter(function(key){return"State"!==key})),data.forEach(function(d){var y0=0;d.ages=color.domain().map(function(name){return{name:name,y0:y0,y1:y0+=+d[name]}})}),x.domain(data.map(function(d){return d.State})),y.domain([0,yAxisCount]),svg.append("g").attr("class","x axis").attr("transform","translate(0,"+height+")").call(xAxis),svg.append("g").attr("class","y axis").call(yAxis).append("text").attr("transform","rotate(-90)").attr("y",4).attr("x",4).attr("dy",".71em").style("text-anchor","end").text("Interventions per Month");var state=svg.selectAll(".state").data(data).enter().append("g").attr("class","g").attr("transform",function(d){return"translate("+x(d.State)+",0)"});state.selectAll("rect").data(function(d){return d.ages}).enter().append("rect").attr("width",x.rangeBand()-2).attr("y",function(d){return y(d.y1)}).attr("height",function(d){return y(d.y0)-y(d.y1)}).style("fill",function(d){return color(d.name)});var legend=svg.selectAll(".legend").data(color.domain().slice().reverse()).enter().append("g").attr("class","legend").attr("transform",function(d,i){return"translate(0,"+20*i+")"});legend.append("rect").attr("x",width-0).attr("width",8).attr("height",8).style("fill",color),legend.append("text").attr("x",width-2).attr("y",4).attr("dy",".25em").style("text-anchor","end").text(function(d){return d})}angular.module("ui.slider",[]).value("uiSliderConfig",{}).directive("uiSlider",["uiSliderConfig","$timeout",function(uiSliderConfig,$timeout){return uiSliderConfig=uiSliderConfig||{},{require:"ngModel",compile:function(){return function(scope,elm,attrs,ngModel){function parseNumber(n,decimals){return decimals?parseFloat(n):parseInt(n)}function destroy(){elm.slider("destroy")}var options=angular.extend(scope.$eval(attrs.uiSlider)||{},uiSliderConfig),prevRangeValues={min:null,max:null},properties=["min","max","step"],useDecimals=angular.isUndefined(attrs.useDecimals)?!1:!0,init=function(){angular.isArray(ngModel.$viewValue)&&options.range!==!0&&(console.warn("Change your range option of ui-slider. When assigning ngModel an array of values then the range option should be set to true."),options.range=!0),angular.forEach(properties,function(property){angular.isDefined(attrs[property])&&(options[property]=parseNumber(attrs[property],useDecimals))}),elm.slider(options),init=angular.noop};angular.forEach(properties,function(property){attrs.$observe(property,function(newVal){newVal&&(init(),elm.slider("option",property,parseNumber(newVal,useDecimals)),ngModel.$render())})}),attrs.$observe("disabled",function(newVal){init(),elm.slider("option","disabled",!!newVal)}),scope.$watch(attrs.uiSlider,function(newVal){init(),void 0!=newVal&&elm.slider("option",newVal)},!0),$timeout(init,0,!0),elm.bind("slide",function(event,ui){ngModel.$setViewValue(ui.values||ui.value),scope.$apply()}),ngModel.$render=function(){init();var method=options.range===!0?"values":"value";options.range||!isNaN(ngModel.$viewValue)||ngModel.$viewValue instanceof Array?options.range&&!angular.isDefined(ngModel.$viewValue)&&(ngModel.$viewValue=[0,0]):ngModel.$viewValue=0,options.range===!0&&(angular.isDefined(options.min)&&options.min>ngModel.$viewValue[0]&&(ngModel.$viewValue[0]=options.min),angular.isDefined(options.max)&&options.max<ngModel.$viewValue[1]&&(ngModel.$viewValue[1]=options.max),ngModel.$viewValue[0]>ngModel.$viewValue[1]&&(prevRangeValues.min>=ngModel.$viewValue[1]&&(ngModel.$viewValue[0]=prevRangeValues.min),prevRangeValues.max<=ngModel.$viewValue[0]&&(ngModel.$viewValue[1]=prevRangeValues.max)),prevRangeValues.min=ngModel.$viewValue[0],prevRangeValues.max=ngModel.$viewValue[1]),elm.slider(method,ngModel.$viewValue)},scope.$watch(attrs.ngModel,function(){options.range===!0&&ngModel.$render()},!0),elm.bind("$destroy",destroy)}}}}]),exports=knapsack,function(){var app=angular.module("interventionApp",["ui.slider"]);app.controller("interventionCtrl",function($scope,$log){function changeAll(){$scope.realizedCosts=countRealizedCosts(),$scope.remainingBudget=$scope.budget-$scope.realizedCosts,$scope.interventions=getInterventions($scope.members),$scope.potentialValue=countValue(),calculateIhaUtil()}function countRealizedCosts(){var costs=0,value=0;return _.each($scope.members,function(m){m.conductedInterventions&&_.each(m.conductedInterventions,function(i){costs+=i.w,"successful"===i.state&&(value+=i.Value)})}),$scope.realizedValue=value,costs}function countValue(){var pv=0,ev=0;return _.each($scope.interventions,function(i){pv+=i.Value,ev+=i.b}),$scope.expectedValue=ev,pv}function countNumberOfGaps(){var count=0;return _.each($scope.members,function(m){count+=m.Gaps.length}),count}function calculateIhaUtil(){var data=[{State:"JAN",planned:0,successful:0,unsuccessful:0},{State:"FEB",planned:0,successful:0,unsuccessful:0},{State:"MAR",planned:0,successful:0,unsuccessful:0},{State:"APR",planned:0,successful:0,unsuccessful:0},{State:"MAY",planned:0,successful:0,unsuccessful:0},{State:"JUN",planned:0,successful:0,unsuccessful:0},{State:"JUL",planned:0,successful:0,unsuccessful:0},{State:"AUG",planned:0,successful:0,unsuccessful:0},{State:"SEP",planned:0,successful:0,unsuccessful:0},{State:"OCT",planned:0,successful:0,unsuccessful:0},{State:"NOV",planned:0,successful:0,unsuccessful:0},{State:"DEC",planned:0,successful:0,unsuccessful:0}],data1=[{State:"JAN",planned:0,successful:0,unsuccessful:0},{State:"FEB",planned:0,successful:0,unsuccessful:0},{State:"MAR",planned:0,successful:0,unsuccessful:0},{State:"APR",planned:0,successful:0,unsuccessful:0},{State:"MAY",planned:0,successful:0,unsuccessful:0},{State:"JUN",planned:0,successful:0,unsuccessful:0},{State:"JUL",planned:0,successful:0,unsuccessful:0},{State:"AUG",planned:0,successful:0,unsuccessful:0},{State:"SEP",planned:0,successful:0,unsuccessful:0},{State:"OCT",planned:0,successful:0,unsuccessful:0},{State:"NOV",planned:0,successful:0,unsuccessful:0},{State:"DEC",planned:0,successful:0,unsuccessful:0}],data2=[{State:"JAN",planned:0,successful:0,unsuccessful:0},{State:"FEB",planned:0,successful:0,unsuccessful:0},{State:"MAR",planned:0,successful:0,unsuccessful:0},{State:"APR",planned:0,successful:0,unsuccessful:0},{State:"MAY",planned:0,successful:0,unsuccessful:0},{State:"JUN",planned:0,successful:0,unsuccessful:0},{State:"JUL",planned:0,successful:0,unsuccessful:0},{State:"AUG",planned:0,successful:0,unsuccessful:0},{State:"SEP",planned:0,successful:0,unsuccessful:0},{State:"OCT",planned:0,successful:0,unsuccessful:0},{State:"NOV",planned:0,successful:0,unsuccessful:0},{State:"DEC",planned:0,successful:0,unsuccessful:0}];_.each(_.filter($scope.interventions,function(i){return"IHA"===i.Name}),function(i){var begin=i.Start.getMonth(),end=i.End.getMonth(),lowest=_.min(data.slice(begin,end+1),function(o){return o.planned});lowest.planned+=1}),_.each($scope.members,function(m){_.each(_.filter(m.conductedInterventions,function(i){return"IHA"===i.Name}),function(i){var begin=i.Start.getMonth(),end=i.End.getMonth(),lowest=_.min(data.slice(begin,end+1),function(o){return o.successful+o.unsuccessful+o.planned});"successful"===i.state?lowest.successful+=1:"unsuccessful"===i.state&&(lowest.unsuccessful+=1)})}),_.each(_.filter($scope.interventions,function(i){return"MEOM"===i.Name}),function(i){var begin=i.Start.getMonth(),end=i.End.getMonth(),lowest=_.min(data2.slice(begin,end+1),function(o){return o.planned});lowest.planned+=1}),_.each($scope.members,function(m){_.each(_.filter(m.conductedInterventions,function(i){return"MEOM"===i.Name}),function(i){var begin=i.Start.getMonth(),end=i.End.getMonth(),lowest=_.min(data2.slice(begin,end+1),function(o){return o.successful+o.unsuccessful+o.planned});"successful"===i.state?lowest.successful+=1:"unsuccessful"===i.state&&(lowest.unsuccessful+=1)})}),_.each(_.filter($scope.interventions,function(i){return"MEOT"===i.Name}),function(i){var begin=i.Start.getMonth(),end=i.End.getMonth(),lowest=_.min(data1.slice(begin,end+1),function(o){return o.planned});lowest.planned+=1}),_.each($scope.members,function(m){_.each(_.filter(m.conductedInterventions,function(i){return"MEOT"===i.Name}),function(i){var begin=i.Start.getMonth(),end=i.End.getMonth(),lowest=_.min(data1.slice(begin,end+1),function(o){return o.successful+o.unsuccessful+o.planned});"successful"===i.state?lowest.successful+=1:"unsuccessful"===i.state&&(lowest.unsuccessful+=1)})});var yMax=_.max(data.concat(data1,data2),function(o){return o.successful+o.unsuccessful+o.planned}),yMaxCount=yMax.successful+yMax.unsuccessful+yMax.planned;stackedBarChart("#iha",data,yMaxCount),stackedBarChart("#meot",data1,yMaxCount),stackedBarChart("#meom",data2,yMaxCount)}function getInterventions(members){var interventions=[];_.each(members,function(member){var iteratedGaps=[];_.each(member.Gaps,function(gap){if("open"===gap.state){var overlappingGaps=_.filter(member.Gaps,function(g){return gap!==g&&g.Start<=gap.End&&g.End>=gap.Start&&!_.contains(iteratedGaps,g)}),mInterventions=mergeInterventions(gap,overlappingGaps);_.each(mInterventions,function(x){x.Member=member,interventions.push(x)}),iteratedGaps.push(gap)}})});var b=0;$scope.remainingBudget>0&&(b=$scope.remainingBudget);var optimizedInterventions=knapsack(interventions,b);return _.sortBy(optimizedInterventions.set,function(i){return i.r}).reverse()}function mergeInterventions(origGap,overlappingGaps){var interventions=[];return _.each(origGap.GapInterventionTypes,function(interventionType){var gapsWithSameInterventionType=gapsWithSameIntervetionType(overlappingGaps,interventionType.Name),benefit=interventionType.SuccessProbability*origGap.Value*$scope[interventionType.Name.toLowerCase()+"Weight"],weight=interventionType.Cost,value=origGap.Value,start=origGap.Start,end=origGap.End,interventionGaps=[origGap],r=benefit-weight;_.each(gapsWithSameInterventionType,function(sgap){var iType=_.findWhere(sgap.GapInterventionTypes,{Name:interventionType.Name});if(iType){var addBenefit=iType.SuccessProbability*sgap.Value;benefit+=addBenefit,r+=addBenefit*$scope[iType.Name.toLowerCase()+"Weight"],value+=sgap.Value,sgap.Start>start&&(start=sgap.Start),sgap.End<end&&(end=sgap.End),interventionGaps.push(sgap)}}),r>0&&interventions.push({Name:interventionType.Name,Start:start,End:end,b:r,w:weight,Value:value,r:r,interventionGaps:interventionGaps})}),interventions}function gapsWithSameIntervetionType(gaps,interventionTypeName){var gapsWithSameInterventionType=[];return _.each(gaps,function(gap){_.contains(_.pluck(gap.GapInterventionTypes,"Name"),interventionTypeName)&&gapsWithSameInterventionType.push(gap)}),gapsWithSameInterventionType}$scope.slider={options:{start:function(event){$log.info("Event: Slider start - set with slider options",event)},stop:function(event){$log.info("Event: Slider stop - set with slider options",event)}}},$scope.members=[{Name:"Adrian Adams",Gaps:[{Name:"AAA",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-05-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Brian Brooks",Gaps:[{Name:"AMM",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6634,Cost:20},{Name:"MEOT",SuccessProbability:.7834,Cost:34},{Name:"IHA",SuccessProbability:.9894,Cost:280}]},{Name:"DMD",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6134,Cost:20},{Name:"MEOT",SuccessProbability:.7934,Cost:34},{Name:"IHA",SuccessProbability:.954,Cost:280}]},{Name:"DDI",Start:new Date("2014-02-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.89134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ARV",Start:new Date("2014-05-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"PBH",Start:new Date("2014-05-02"),End:new Date("2014-11-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"CMR",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9434,Cost:20},{Name:"IHA",SuccessProbability:.974,Cost:280}]}]},{Name:"Cecillia Citron",Gaps:[{Name:"HRM",Start:new Date("2014-09-02"),End:new Date("2014-12-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"PNU",Start:new Date("2014-07-02"),End:new Date("2014-12-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"David Doodle",Gaps:[{Name:"CDC-E",Start:new Date("2014-01-02"),End:new Date("2014-07-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7734,Cost:20},{Name:"MEOT",SuccessProbability:.7334,Cost:34},{Name:"IHA",SuccessProbability:.924,Cost:280}]},{Name:"CDC-N",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6934,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"CDC-H",Start:new Date("2014-05-02"),End:new Date("2014-09-02"),Value:239,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.94834,Cost:20},{Name:"IHA",SuccessProbability:.9874,Cost:280}]},{Name:"MUI",Start:new Date("2014-05-02"),End:new Date("2014-11-02"),Value:576,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.944,Cost:280}]},{Name:"CDC-L",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.8834,Cost:20},{Name:"IHA",SuccessProbability:.934,Cost:280}]}]},{Name:"Eddy Edision",Gaps:[{Name:"AAA",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-05-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Fabian Fiddle",Gaps:[{Name:"AAA",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-05-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Greogory Grok",Gaps:[{Name:"AMM",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6634,Cost:20},{Name:"MEOT",SuccessProbability:.7834,Cost:34},{Name:"IHA",SuccessProbability:.9894,Cost:280}]},{Name:"DMD",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6134,Cost:20},{Name:"MEOT",SuccessProbability:.7934,Cost:34},{Name:"IHA",SuccessProbability:.954,Cost:280}]},{Name:"DDI",Start:new Date("2014-02-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.89134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ARV",Start:new Date("2014-05-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"PBH",Start:new Date("2014-05-02"),End:new Date("2014-11-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"CMR",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9434,Cost:20},{Name:"IHA",SuccessProbability:.974,Cost:280}]}]},{Name:"Hillary Hicks",Gaps:[{Name:"HRM",Start:new Date("2014-09-02"),End:new Date("2014-12-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"PNU",Start:new Date("2014-07-02"),End:new Date("2014-12-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Isha Indie",Gaps:[{Name:"CDC-E",Start:new Date("2014-01-02"),End:new Date("2014-07-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7734,Cost:20},{Name:"MEOT",SuccessProbability:.7334,Cost:34},{Name:"IHA",SuccessProbability:.924,Cost:280}]},{Name:"CDC-N",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6934,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"CDC-H",Start:new Date("2014-05-02"),End:new Date("2014-09-02"),Value:239,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.94834,Cost:20},{Name:"IHA",SuccessProbability:.9874,Cost:280}]},{Name:"MUI",Start:new Date("2014-05-02"),End:new Date("2014-11-02"),Value:576,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.944,Cost:280}]},{Name:"CDC-L",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.8834,Cost:20},{Name:"IHA",SuccessProbability:.934,Cost:280}]}]},{Name:"Jack Jubbi",Gaps:[{Name:"AAA",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-02-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-05-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-08-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Kobe Kenobi",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:360,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-01-02"),End:new Date("2014-06-02"),Value:560,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-01-02"),End:new Date("2014-07-02"),Value:630,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-01-02"),End:new Date("2014-12-02"),Value:730,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Ismael Ikky",Gaps:[{Name:"CDC-N",Start:new Date("2014-03-02"),End:new Date("2014-03-02"),Value:343,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-02"),End:new Date("2014-06-02"),Value:572,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-03-02"),End:new Date("2014-07-02"),Value:618,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-03-02"),End:new Date("2014-12-02"),Value:745,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Larry Leffers",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Mandy Macy",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Nancy Nadine",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Olando Ortis",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Peter Pan",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Quant Qotis",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Rick Richy",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Steven Stiffens",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]},{Name:"Tom Tubbles",Gaps:[{Name:"CDC-N",Start:new Date("2014-01-02"),End:new Date("2014-03-02"),Value:843,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.6834,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"ASM",Start:new Date("2014-03-03"),End:new Date("2014-06-02"),Value:772,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.7134,Cost:20},{Name:"MEOT",SuccessProbability:.7234,Cost:34},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"MSC",Start:new Date("2014-06-03"),End:new Date("2014-07-02"),Value:918,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]},{Name:"COL",Start:new Date("2014-07-03"),End:new Date("2014-12-02"),Value:845,state:"open",GapInterventionTypes:[{Name:"MEOM",SuccessProbability:.9134,Cost:20},{Name:"IHA",SuccessProbability:.994,Cost:280}]}]}],$scope.ihaWeight=1,$scope.meotWeight=1,$scope.meomWeight=1,$scope.budget=500,$scope.remainingBudget=$scope.budget,$scope.realizedValue=0,$scope.realizedCosts=countRealizedCosts(),$scope.interventions=getInterventions($scope.members),$scope.potentialValue=countValue(),$scope.expectedValue;
$scope.change=function(){changeAll()},$scope.numberOfGaps=countNumberOfGaps(),$scope.simulateSuccessful=function(i){i.state="successful",_.each(i.interventionGaps,function(x){x.state="closed"}),i.Member.conductedInterventions||(i.Member.conductedInterventions=[]),i.Member.conductedInterventions.push(i),changeAll()},$scope.simulateUnsuccessful=function(i){i.state="unsuccessful",_.each(i.interventionGaps,function(x){x.state="closed"}),i.Member.conductedInterventions||(i.Member.conductedInterventions=[]),i.Member.conductedInterventions.push(i),changeAll()}})}();